CREATE DATABASE IF NOT EXIST tos;

DROP TABLE IF EXISTS tos.tcic_integ_cont_hst;

CREATE EXTERNAL TABLE IF NOT EXISTS tos.tcic_integ_cont_hst
(
  CONT_DT STRING,
  INTEG_CONT_EVT_ID STRING,
  CONT_IDNT_CL_CD STRING,
  CONT_IDNT_CL_VAL STRING,
  CONT_DTM STRING,
  CUST_NUM STRING,
  SVC_MGMT_NUM STRING,
  ACNT_NUM STRING,
  TID STRING,
  T_ID_NUM STRING,
  MBR_CARD_NUM1 STRING,
  OUT_IDNT_NUM STRING,
  INTEG_CONT_CL_CD STRING,
  INTEG_CONT_OP_CL_CD STRING,
  INTEG_CONT_RSN_CD STRING,
  CMPGN_NUM STRING,
  SRC_SYS_CL_CD STRING,
  SRC_OWNR_NM STRING,
  SRC_OBJ_NM STRING,
  SRC_CHG_CD_VAL STRING,
  SRC_RSN_CD_VAL STRING,
  SRC_CONT_GRP_ID STRING,
  SRC_SER_NUM STRING,
  SRC_DTL_SER_NUM STRING,
  CHNL_CONT_WAY_CD STRING,
  CO_CL_CD STRING,
  SVC_CD STRING,
  RCV_SEQ STRING,
  TOS_EVENT_KEY STRING,
  TOS_EVENT_DTM STRING,
  TOS_IS_DB_SAVE STRING,
  TOS_IS_CEP_SEND STRING,
  TOS_SPARK_MAP_DTM STRING,
  TOS_KAFKA_SEND_DTM STRING,
  TOS_HIVE_SAVE_DTM STRING,
  HEADER STRING,
  BODY STRING
)
PARTITIONED BY (DT String, HH String)
STORED AS ORC
LOCATION '/offer_hive/tos.db/tcic_integ_cont_hst.tb'
TBLPROPERTIES("orc.compress"="SNAPPY");